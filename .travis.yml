dist: trusty
#Docker container based
sudo: false
language: java
cache:
  directories:
  - $HOME/.m2

jdk:
  - openjdk7
  - oraclejdk8
  - oraclejdk9
env:
  - FEDORA_VERSION=3.6.2
  - FEDORA_VERSION=3.7.0
  - FEDORA_VERSION=3.7.1
  - FEDORA_VERSION=3.8.1
matrix:
  include:
     - jdk: openjdk6
       env: FEDORA_VERSION="3.6.2"
       addons:
         apt:
           packages:
             - openjdk-6-jdk
       install:
         - echo "Downloading Maven 3.0";
         - wget https://archive.apache.org/dist/maven/binaries/apache-maven-3.0-bin.zip || travis_terminate 1
         - unzip -qq apache-maven-3.0-bin.zip || travis_terminate 1
         - export M2_HOME=$PWD/apache-maven-3.0
         - export PATH=$M2_HOME/bin:$PATH
         - mvn -version
         - mvn clean package install -DskipTests -Dgpg.skip
     - jdk: openjdk6
       env: FEDORA_VERSION="3.7.0"
       addons:
         apt:
           packages:
             - openjdk-6-jdk
       install:
         - echo "Downloading Maven 3.0";
         - wget https://archive.apache.org/dist/maven/binaries/apache-maven-3.0-bin.zip || travis_terminate 1
         - unzip -qq apache-maven-3.0-bin.zip || travis_terminate 1
         - export M2_HOME=$PWD/apache-maven-3.0
         - export PATH=$M2_HOME/bin:$PATH
         - mvn -version
         - mvn clean package install -DskipTests -Dgpg.skip
     - jdk: openjdk6
       env: FEDORA_VERSION="3.7.1"
       addons:
         apt:
           packages:
             - openjdk-6-jdk
       install:
         - echo "Downloading Maven 3.0";
         - wget https://archive.apache.org/dist/maven/binaries/apache-maven-3.0-bin.zip || travis_terminate 1
         - unzip -qq apache-maven-3.0-bin.zip || travis_terminate 1
         - export M2_HOME=$PWD/apache-maven-3.0
         - export PATH=$M2_HOME/bin:$PATH
         - mvn -version
         - mvn clean package install -DskipTests -Dgpg.skip
     - jdk: openjdk6
       env: FEDORA_VERSION="3.8.1"
       addons:
         apt:
           packages:
             - openjdk-6-jdk
       install:
         - echo "Downloading Maven 3.0";
         - wget https://archive.apache.org/dist/maven/binaries/apache-maven-3.0-bin.zip || travis_terminate 1
         - unzip -qq apache-maven-3.0-bin.zip || travis_terminate 1
         - export M2_HOME=$PWD/apache-maven-3.0
         - export PATH=$M2_HOME/bin:$PATH
         - mvn -version
         - mvn clean package install -DskipTests -Dgpg.skip
  allow_failures:
    - jdk: oraclejdk9

script:
  - mvn test -DskipTests=false -Dfedora.version=$FEDORA_VERSION -Ddb.name=drupal_test -Ddb.user=travis -Ddb.pass=""
  - mvn test -DskipTests=false -Dfedora.version=$FEDORA_VERSION -Ddb.name=drupal_test -Ddb.user=postgres -Ddb.pass="" -Ddb.port=5432 -Ddb.class="org.postgresql.Driver" -Ddb.scheme="jdbc:postgresql" -Ddb.group=postgresql -Ddb.artifact=postgresql -Ddb.version="9.1-901.jdbc4"
